I'm on cuda, Rank: 0
Embedding dict loaded from: OP model
------------------Experiment is on GPT embeddings-----------------------
Rank 0: Model hash: 136acbf81f7164d3450a60a8b901c723
None
Epoch 000 (TRA):   0%|| 0/36775 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/output/NEW/dev/train.py", line 263, in <module>
    mdl.fit(dat_trn.features, dat_vld.features, dat_trn.labels, dat_vld.labels)
  File "/openbayes/home/NEW/common/ml_frame.py", line 27, in wrapper
    return func(*bound_args.args, **bound_args.kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openbayes/home/NEW/model/adrd.py", line 87, in fit
    self.train_one_epoch()
  File "/openbayes/home/NEW/common/ml_frame.py", line 27, in wrapper
    return func(*bound_args.args, **bound_args.kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openbayes/home/NEW/model/adrd.py", line 241, in train_one_epoch
    representation, outputs = self.net_(x_batch, mask)
                              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openbayes/home/NEW/common/ml_frame.py", line 27, in wrapper
    return func(*bound_args.args, **bound_args.kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openbayes/home/NEW/framework/transformer.py", line 54, in forward
    out_trf = self.transformer_layer(out_emb, mask)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/openbayes/home/NEW/framework/new_llm_finetune_trf.py", line 62, in forward
    mask_all = mask_all.unsqueeze(1).expand(-1, self.S + self.T, -1).repeat(nhead, 1, 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: repeat(): argument 'repeats' (position 1) must be tuple of ints, but found element of type NoneType at pos 0
[rank0]: Traceback (most recent call last):
[rank0]:   File "/output/NEW/dev/train.py", line 263, in <module>
[rank0]:     mdl.fit(dat_trn.features, dat_vld.features, dat_trn.labels, dat_vld.labels)
[rank0]:   File "/openbayes/home/NEW/common/ml_frame.py", line 27, in wrapper
[rank0]:     return func(*bound_args.args, **bound_args.kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/openbayes/home/NEW/model/adrd.py", line 87, in fit
[rank0]:     self.train_one_epoch()
[rank0]:   File "/openbayes/home/NEW/common/ml_frame.py", line 27, in wrapper
[rank0]:     return func(*bound_args.args, **bound_args.kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/openbayes/home/NEW/model/adrd.py", line 241, in train_one_epoch
[rank0]:     representation, outputs = self.net_(x_batch, mask)
[rank0]:                               ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
[rank0]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank0]:          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
[rank0]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/openbayes/home/NEW/common/ml_frame.py", line 27, in wrapper
[rank0]:     return func(*bound_args.args, **bound_args.kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/openbayes/home/NEW/framework/transformer.py", line 54, in forward
[rank0]:     out_trf = self.transformer_layer(out_emb, mask)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/usr/local/envs/LMTDE/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/openbayes/home/NEW/framework/new_llm_finetune_trf.py", line 62, in forward
[rank0]:     mask_all = mask_all.unsqueeze(1).expand(-1, self.S + self.T, -1).repeat(nhead, 1, 1)
[rank0]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: TypeError: repeat(): argument 'repeats' (position 1) must be tuple of ints, but found element of type NoneType at pos 0
